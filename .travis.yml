arch: amd64

language: java

notifications:
  email: false

notifications:
  email: false

sudo: required

jdk:
  - oraclejdk8

install: true

before_install:
  - |
    if [[ $TRAVIS_CPU_ARCH == "arm64" ]]; then
      travis_install_jdk_package() {
        local JAVA_VERSION
        JAVA_VERSION="$1"
        sudo apt-get update -y
        PACKAGE="adoptopenjdk-${JAVA_VERSION}-hotspot"
        if ! dpkg -s "$PACKAGE" >/dev/null 2>&1; then
          if dpkg-query -l adoptopenjdk* ; then
            dpkg-query -l adoptopenjdk* | grep adoptopenjdk | awk '{print $2}' | xargs sudo dpkg -P
          fi
          wget -nv -O - https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public | sudo apt-key add -
          sudo add-apt-repository --yes https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/
          sudo apt-get update -yq
          sudo apt-get -yq --no-install-suggests --no-install-recommends install "$PACKAGE" || true
          sudo update-java-alternatives -s "$PACKAGE"*
          if ! dpkg-query -l maven &>/dev/null; then sudo apt-get -yq install maven; fi
        fi
      }
      travis_install_jdk_package 8
    fi
